---
title: "Fatalities & Injuries from Severe Weather Events"
subtitle: "How do they change over time and region?"
author: "inlbk"
date: "April 2017"
output:
  ioslides_presentation: default
---

```{r, echo=FALSE, eval=TRUE, message=FALSE}
#install.packages("plotly")
library(plotly)
library(plyr)
library(dplyr)
library(data.table)
library(stringr)
library(ggplot2)
library(shiny)
set.seed(5678)
```

## NOAA Severe Weather Events

The [NOAA severe weather event database](https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2) [contains](https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf):

- Year (1950-2011)
- Event (48 categories, e.g. Tornado, Flood...)
- State*
- Fatalities
- Injuries
 
 
*This app is restricted to the continental United States

## Geographic Regions of the U.S.

- Geographic regions are based on [NOAA climate type](https://www.ncdc.noaa.gov/monitoring-references/maps/us-climate-regions.php) 
      - South: AR, KS, LA, MS, OK, TX
      - Ohio Valley: IL, IN, KY, MO, OH, TN, WV
      - Southeast: AL, FL, GA, NC, SC, VA, DC
      - Northeast: CT, DE, ME, MD, MA, NH, NJ, NY, PA, RI, VT
      - Upper Midwest: IA, MI, MN, WI
      - Northern Rockies and Plains: MT, NE, ND, SD, WY
      - Southwest: AZ, CO, NM, UT
      - West: CA, NV
      - Northwest: ID, OR, WA

## User Inputs to the App

<div class="columns-2">
  ![](/Users/inaloobeek/Documents/Coursera/Data Scientist Specialization - JHU/9 Developing Data Products - project remaining/Week 4 - project remaining/My project/Final Project (No Events)/User_interface_5.png)

The user can select:

- Starting year
- Ending year
- Whether to include fatalities
- Whether to include injuries

</div>

<div class="centered">
...

</div>
Future refinements will enable the user to specify which regions of the U.S. to include, which storm events to include, and whether to display the data on a map of the United States.

## The Output is a Bar-Graph of Fatalities/Injuries per Region

```{r, echo=FALSE, eval=TRUE, message=FALSE}
# Read the data (created by processing and cleaning the NOAA dataset)
regionsums<-read.table("StormDatabyRegionNotEvents")
regionorder<-c("South","Ohio Valley","Southeast","Northeast","Upper Midwest","Northern Rockies and Plains","Southwest","West","Northwest")

# Set defaults to be all years and to include both fatalities and injuries.
beginY<-1970
endY<-1990
show_fatalities<-TRUE
show_injuries<-TRUE

# Plot total fatalities and injuries for each event type.
if(show_fatalities & show_injuries){
      region.m<-data.table()
      region.m = melt(regionsums[regionsums$YEAR<endY+1 &   
                  regionsums$YEAR>beginY-1,c(2,3,4)],id.vars='REGION')
      colnames(region.m)<-c("Region","Type","Number")
      
      ggplot(region.m,aes(Region,Number,fill=Type)) +
            scale_x_discrete(limits = regionorder) +
            theme(axis.text.x = element_text(hjust=1, angle=70),
                  plot.title = element_text(hjust = 0.5)) +
            ggtitle("Fatalities and Injuries Caused by Severe Weather Events") +
            ylab('Fatalities/Injuries') + 
            xlab('Region of the Contiguous United States
                             \n South: AR, KS, LA, MS, OK, TX        Ohio Valley: IL, IN, KY, MO, OH, TN, WV \n Southeast: AL, FL, GA, NC, SC, VA, DC    Northeast: CT, DE, ME, MD, MA, NH, NJ, NY, PA, RI, VT\n Upper Midwest: IA, MI, MN, WI        Northern Rockies and Plains: MT, NE, ND, SD, WY\n Southwest: AZ, CO, NM, UT        West: CA, NV        Northwest: ID, OR, WA') +
            geom_bar(stat="identity") +
            scale_fill_manual(values=c("#FF6666","#33CCCC"))
}
```


```{r, echo=FALSE, eval=FALSE, message=FALSE}
# Published at https://inlbk.github.io/Week_3_Project.html
```
